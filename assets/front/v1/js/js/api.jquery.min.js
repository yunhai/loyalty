function floatToString(a,r){var t=a.toFixed(r).toString();return t.replace(".",Haravan.decimal),t.match("^[."+Haravan.decimal+"]d+")?"0"+t:t}function attributeToString(a){return"string"!=typeof a&&(a+="","undefined"===a&&(a="")),jQuery.trim(a)}"undefined"==typeof Haravan&&(Haravan={}),Haravan.cultures=[{code:"vi-VN",thousands:",",decimal:".",numberdecimal:0,money_format:"{{amount}}"},{code:"en-US",thousands:",",decimal:".",numberdecimal:2,money_format:"{{amount}}"}],Haravan.getCulture=function(a){var r;for(n=0;n<Haravan.cultures.length;n++)if(Haravan.cultures[n].code==a){r=Haravan.cultures[n];break}return r||(r=Haravan.cultures[0]),r},Haravan.format=Haravan.getCulture(Haravan.culture),Haravan.money_format="{{amount}}",Haravan.onError=function(XMLHttpRequest,textStatus){var data=eval("("+XMLHttpRequest.responseText+")");data.message?alert(data.message+"("+data.status+"): "+data.description):alert("Error : "+Haravan.fullMessagesFromErrors(data).join("; ")+".")},Haravan.fullMessagesFromErrors=function(a){var r=[];return jQuery.each(a,function(a,t){jQuery.each(t,function(t,n){r.push(a+" "+n)})}),r},Haravan.onCartUpdate=function(a){alert("There are now "+a.item_count+" items in the cart.")},Haravan.onCartShippingRatesUpdate=function(a,r){var t="";r.zip&&(t+=r.zip+", "),r.province&&(t+=r.province+", "),t+=r.country,alert("There are "+a.length+" shipping rates available for "+t+", starting at "+Haravan.formatMoney(a[0].price)+".")},Haravan.onItemAdded=function(a){alert(a.title+" was added to your shopping cart.")},Haravan.onProduct=function(a){alert("Received everything we ever wanted to know about "+a.title)},Haravan.formatMoney=function(a,r){function t(a){return a.replace(/(\d)(?=(\d\d\d)+(?!\d))/g,"$1"+Haravan.format.thousands)}a/=100,"string"==typeof a&&(a=a.replace(Haravan.format.thousands,""));var n="",e=/\{\{\s*(\w+)\s*\}\}/,o=r||this.money_format;switch(o.match(e)[1]){case"amount":n=t(floatToString(a,Haravan.format.numberdecimal));break;case"amount_no_decimals":n=t(floatToString(a,0));break;case"amount_with_comma_separator":n=floatToString(a,Haravan.format.numberdecimal).replace(/\./,",");break;case"amount_no_decimals_with_comma_separator":n=t(floatToString(a,0)).replace(/\./,",")}return o.replace(e,n)},Haravan.resizeImage=function(a,r){try{if("original"==r)return a;var t=a.match(/(.*\/[\w\-\_\.]+)\.(\w{2,4})/);return t[1].replace(/http:/g,"")+"_"+r+"."+t[2]}catch(n){return a.replace(/http:/g,"")}},Haravan.addItem=function(a,r,t){var r=r||1,n={type:"POST",url:"/cart/add.js",data:"quantity="+r+"&id="+a,dataType:"json",success:function(a){"function"==typeof t?t(a):Haravan.onItemAdded(a)},error:function(a,r){Haravan.onError(a,r)}};jQuery.ajax(n)},Haravan.addItemFromForm=function(a,r){var t={type:"POST",url:"/cart/add.js",data:jQuery("#"+a).serialize(),dataType:"json",success:function(a){"function"==typeof r?r(a):Haravan.onItemAdded(a)},error:function(a,r){Haravan.onError(a,r)}};jQuery.ajax(t)},Haravan.getCart=function(a){jQuery.getJSON("/cart.js",function(r,t){"function"==typeof a?a(r):Haravan.onCartUpdate(r)})},Haravan.getCartShippingRatesForDestination=function(a,r){var t={type:"GET",url:"/cart/shipping_rates.json",data:Haravan.param({shipping_address:a}),dataType:"json",success:function(t){rates=t.shipping_rates,"function"==typeof r?r(rates,a):Haravan.onCartShippingRatesUpdate(rates,a)},error:function(a,r){Haravan.onError(a,r)}};jQuery.ajax(t)},Haravan.getProduct=function(a,r){jQuery.getJSON("/products/"+a+".js",function(a,t){"function"==typeof r?r(a):Haravan.onProduct(a)})},Haravan.changeItem=function(a,r,t){var n={type:"POST",url:"/cart/change.js",data:"quantity="+r+"&id="+a,dataType:"json",success:function(a){"function"==typeof t?t(a):Haravan.onCartUpdate(a)},error:function(a,r){Haravan.onError(a,r)}};jQuery.ajax(n)},Haravan.removeItem=function(a,r){var t={type:"POST",url:"/cart/change.js",data:"quantity=0&id="+a,dataType:"json",success:function(a){"function"==typeof r?r(a):Haravan.onCartUpdate(a)},error:function(a,r){Haravan.onError(a,r)}};jQuery.ajax(t)},Haravan.clear=function(a){var r={type:"POST",url:"/cart/clear.js",data:"",dataType:"json",success:function(r){"function"==typeof a?a(r):Haravan.onCartUpdate(r)},error:function(a,r){Haravan.onError(a,r)}};jQuery.ajax(r)},Haravan.updateCartFromForm=function(a,r){var t={type:"POST",url:"/cart/update.js",data:jQuery("#"+a).serialize(),dataType:"json",success:function(a){"function"==typeof r?r(a):Haravan.onCartUpdate(a)},error:function(a,r){Haravan.onError(a,r)}};jQuery.ajax(t)},Haravan.updateCartAttributes=function(a,r){var t="";jQuery.isArray(a)?jQuery.each(a,function(a,r){var n=attributeToString(r.key);""!==n&&(t+="attributes["+n+"]="+attributeToString(r.value)+"&")}):"object"==typeof a&&null!==a&&jQuery.each(a,function(a,r){t+="attributes["+attributeToString(a)+"]="+attributeToString(r)+"&"});var n={type:"POST",url:"/cart/update.js",data:t,dataType:"json",success:function(a){"function"==typeof r?r(a):Haravan.onCartUpdate(a)},error:function(a,r){Haravan.onError(a,r)}};jQuery.ajax(n)},Haravan.updateCartNote=function(a,r){var t={type:"POST",url:"/cart/update.js",data:"note="+attributeToString(a),dataType:"json",success:function(a){"function"==typeof r?r(a):Haravan.onCartUpdate(a)},error:function(a,r){Haravan.onError(a,r)}};jQuery.ajax(t)},jQuery.fn.jquery>="1.4"?Haravan.param=jQuery.param:(Haravan.param=function(a){var r=[],t=function(a,t){t=jQuery.isFunction(t)?t():t,r[r.length]=encodeURIComponent(a)+"="+encodeURIComponent(t)};if(jQuery.isArray(a)||a.jquery)jQuery.each(a,function(){t(this.name,this.value)});else for(var n in a)Haravan.buildParams(n,a[n],t);return r.join("&").replace(/%20/g,"+")},Haravan.buildParams=function(a,r,t){jQuery.isArray(r)&&r.length?jQuery.each(r,function(r,n){rbracket.test(a)?t(a,n):Haravan.buildParams(a+"["+("object"==typeof n||jQuery.isArray(n)?r:"")+"]",n,t)}):null!=r&&"object"==typeof r?Haravan.isEmptyObject(r)?t(a,""):jQuery.each(r,function(r,n){Haravan.buildParams(a+"["+r+"]",n,t)}):t(a,r)},Haravan.isEmptyObject=function(a){for(var r in a)return!1;return!0});